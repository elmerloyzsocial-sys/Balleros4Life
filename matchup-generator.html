<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Basketball Matchup Generator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: Arial, sans-serif; background: #f7f7fa; margin: 0; padding: 0; }
    .container { max-width: 500px; margin: 2em auto; background: #fff; padding: 2em 1.5em; border-radius: 10px; box-shadow: 0 2px 12px #aaa2; }
    h1 { text-align: center; color: #263238; }
    label { font-weight: 600; margin-top: 1em; display: block; }
    textarea, input[type=number] { width: 100%; padding: 0.6em 0.7em; border-radius: 6px; border: 1px solid #e5e5e5; margin-top: 0.4em; box-sizing: border-box; font-size: 1.05em; }
    button { background: #f7b32b; color: #222; font-weight: bold; border: none; border-radius: 6px; padding: 0.7em 1.5em; font-size: 1.08em; margin-top: 1em; cursor: pointer; }
    .results { margin-top: 2em; }
    .game { background: #f7f7fa; border-radius: 8px; margin-bottom: 1em; padding: 1em 1em; border: 1px solid #e5e5e5; }
    .game-title { color: #263238; font-size: 1.06em; font-weight: 600; margin-bottom: 0.5em; }
    .unassigned, .notice { color: #d32f2f; margin-top: 1em; padding: 0.8em; background: #fff3f3; border-radius: 6px; border: 1px solid #ffc3c3; }
    .notice { color: #f57c00; background: #fffbe9; border-color: #ffe0b2; }
    table { width: 100%; border-collapse: collapse; margin-top: 1.5em; background: #f9f9fc; border-radius: 8px; overflow: hidden; }
    th, td { padding: 0.6em 0.8em; border: 1px solid #e5e5e5; text-align: left; }
    th { background: #f7b32b; color: #222; }
    td { background: #fff; }
    caption { text-align: left; font-weight: bold; font-size: 1.08em; margin-bottom: 0.4em; color: #263238; }
    @media (max-width: 600px) {
      .container { max-width: 99vw; padding: 1em 0.3em; }
      table, th, td { font-size: 0.98em; }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Basketball Matchup Generator</h1>
    <form id="matchupForm" autocomplete="off">
      <label for="players">List of Players (comma or line separated):</label>
      <textarea id="players" rows="5" placeholder="e.g. John, Mike, Sarah, ..."></textarea>
      <label for="games">Number of Games:</label>
      <input type="number" id="games" min="1" max="99" value="3" />
      <button type="submit">Generate Matchups</button>
    </form>
    <div class="results" id="results"></div>
  </div>
  <script>
    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    document.getElementById('matchupForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const playerStr = document.getElementById('players').value;
      const numGames = parseInt(document.getElementById('games').value, 10);

      // Parse and clean player names
      let players = playerStr.split(/[\n,]+/)
        .map(p => p.trim())
        .filter(p => p.length > 0);

      // Minimum 1 game, minimum 1 player
      if (players.length === 0) {
        document.getElementById('results').innerHTML = "<div class='unassigned'>Please enter at least one player.</div>";
        return;
      }
      if (numGames < 1) {
        document.getElementById('results').innerHTML = "<div class='unassigned'>Number of games must be at least 1.</div>";
        return;
      }

      // Distribute games per player as evenly as possible
      const totalSpots = numGames * 10;
      const numPlayers = players.length;

      // Each player gets at least Math.floor(totalSpots / numPlayers) games
      const minGamesPerPlayer = Math.floor(totalSpots / numPlayers);
      const extraSpots = totalSpots % numPlayers; // Some players get an extra game

      // Build an assignment array: for each player, how many games they get
      let assignments = [];
      for (let i = 0; i < numPlayers; i++) {
        let count = minGamesPerPlayer + (i < extraSpots ? 1 : 0);
        assignments.push({ name: players[i], remaining: count, assigned: [] });
      }

      // We want to fill numGames games with 10 players each
      let gamesArr = Array.from({ length: numGames }, () => []);

      // To avoid duplicates within the same game, we track which players are already in the game
      // For fair distribution, shuffle players at each game
      for (let g = 0; g < numGames; g++) {
        // Find all players who still have games left
        let candidates = assignments.filter(a => a.remaining > 0);
        let usedNames = new Set();

        // For each spot in the game
        for (let s = 0; s < 10; s++) {
          // Pick a candidate not already in this game
          let available = candidates.filter(a => !usedNames.has(a.name));
          if (available.length === 0) {
            // All candidates used up for this game, allow duplicates for this game (since requirement allows)
            available = candidates;
          }
          shuffle(available);
          let chosen = available[0];
          gamesArr[g].push(chosen.name);
          chosen.remaining--;
          chosen.assigned.push(g + 1);
          usedNames.add(chosen.name);
        }
      }

      // Prepare HTML output -- ONLY show the first game
      let html = `<div class="game">
        <div class="game-title">Game 1 Matchup:</div>
        <ol>${gamesArr[0].map(p => `<li>${p}</li>`).join('')}</ol>
      </div>`;

      // Player games played table
      html += `<table>
        <caption>Player Participation</caption>
        <thead>
          <tr>
            <th>Player Name</th>
            <th>Games Played</th>
            <th>Game Numbers</th>
          </tr>
        </thead>
        <tbody>
        ${assignments.map(a => `
          <tr>
            <td>${a.name}</td>
            <td>${a.assigned.length}</td>
            <td>${a.assigned.join(', ')}</td>
          </tr>
        `).join('')}
        </tbody>
      </table>`;

      document.getElementById('results').innerHTML = html;
    });
  </script>
</body>
</html>