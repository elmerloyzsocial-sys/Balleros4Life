<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Basketball Matchup Generator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: Arial, sans-serif; background: #f7f7fa; margin: 0; padding: 0; }
    .container { max-width: 500px; margin: 2em auto; background: #fff; padding: 2em 1.5em; border-radius: 10px; box-shadow: 0 2px 12px #aaa2; }
    h1 { text-align: center; color: #263238; }
    label { font-weight: 600; margin-top: 1em; display: block; }
    textarea, input[type=number] { width: 100%; padding: 0.6em 0.7em; border-radius: 6px; border: 1px solid #e5e5e5; margin-top: 0.4em; box-sizing: border-box; font-size: 1.05em; }
    button { background: #f7b32b; color: #222; font-weight: bold; border: none; border-radius: 6px; padding: 0.7em 1.5em; font-size: 1.08em; margin-top: 1em; cursor: pointer; }
    .results { margin-top: 2em; }
    .game { background: #f7f7fa; border-radius: 8px; margin-bottom: 1em; padding: 1em 1em; border: 1px solid #e5e5e5; }
    .game-title { color: #263238; font-size: 1.06em; font-weight: 600; margin-bottom: 0.5em; }
    .unassigned { color: #d32f2f; margin-top: 1em; padding: 0.8em; background: #fff3f3; border-radius: 6px; border: 1px solid #ffc3c3; }
    @media (max-width: 600px) {
      .container { max-width: 99vw; padding: 1em 0.3em; }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Basketball Matchup Generator</h1>
    <form id="matchupForm" autocomplete="off">
      <label for="players">List of Players (comma or line separated):</label>
      <textarea id="players" rows="5" placeholder="e.g. John, Mike, Sarah, ..."></textarea>
      <label for="games">Number of Games:</label>
      <input type="number" id="games" min="1" max="99" value="3" />
      <button type="submit">Generate Matchups</button>
    </form>
    <div class="results" id="results"></div>
  </div>
  <script>
    function shuffle(array) {
      for(let i=array.length-1;i>0;i--){
        const j=Math.floor(Math.random()*(i+1));
        [array[i],array[j]]=[array[j],array[i]];
      }
      return array;
    }

    document.getElementById('matchupForm').addEventListener('submit', function(e){
      e.preventDefault();
      const playerStr = document.getElementById('players').value;
      const numGames = parseInt(document.getElementById('games').value, 10);

      // Parse player names
      let players = playerStr.split(/[\n,]+/)
        .map(p => p.trim())
        .filter(p => p.length > 0);

      if(players.length < 10) {
        document.getElementById('results').innerHTML = "<div class='unassigned'>Need at least 10 players.</div>";
        return;
      }
      if(numGames < 1) {
        document.getElementById('results').innerHTML = "<div class='unassigned'>Number of games must be at least 1.</div>";
        return;
      }

      // Shuffle for fairness
      players = shuffle(players);

      // Assign players to games
      // Each game needs 10 players
      const totalSpots = numGames * 10;
      const numPlayers = players.length;
      // Calculate how many games each player gets
      const gamesPerPlayer = Math.floor(totalSpots / numPlayers);
      const leftoverSpots = totalSpots % numPlayers;

      // Build assignment array
      // Example: If gamesPerPlayer = 2, leftoverSpots = 4, first 4 players get an extra game
      let assignments = [];
      for(let i=0;i<numPlayers;i++){
        let count = gamesPerPlayer + (i < leftoverSpots ? 1 : 0);
        assignments.push({ name: players[i], games: count, assigned: [] });
      }

      // Now assign players to games as evenly as possible
      let gamesArr = Array.from({length: numGames}, ()=>[]);
      // Create a flat list where each player appears as many times as their game count
      let pool = [];
      assignments.forEach(a=>{
        for(let i=0;i<a.games;i++) pool.push(a.name);
      });
      // Shuffle pool for fairness
      pool = shuffle(pool);

      // Assign 10 players per game
      for(let g=0;g<numGames;g++){
        for(let i=0;i<10;i++){
          // Find a player who is not already in this game
          let idx = pool.findIndex(p => !gamesArr[g].includes(p));
          if(idx === -1) break; // not enough unique players left for this game
          let player = pool.splice(idx,1)[0];
          gamesArr[g].push(player);

          // Mark assigned
          let aObj = assignments.find(a=>a.name===player);
          aObj.assigned.push(g+1);
        }
      }

      // Prepare HTML output
      let html = "";
      gamesArr.forEach((players, idx)=>{
        html += `<div class="game">
          <div class="game-title">Game ${idx+1} Matchup:</div>
          <ol>${players.map(p=>`<li>${p}</li>`).join('')}</ol>
        </div>`;
      });

      // Find any player who couldn't be assigned to all their possible games
      let unassigned = assignments.filter(a=>a.assigned.length < a.games);
      if(unassigned.length) {
        html += `<div class="unassigned"><strong>Players who could not be assigned to all their games:</strong><br/>${unassigned.map(a=>a.name).join(', ')}</div>`;
      } else {
        // Also show if a player couldn't play in other games (asked in request)
        let notInAllGames = assignments.filter(a=>a.assigned.length < numGames);
        if(notInAllGames.length) {
          html += `<div class="unassigned"><strong>Players not in all games:</strong><br/>${notInAllGames.map(a=>a.name).join(', ')}</div>`;
        }
      }

      document.getElementById('results').innerHTML = html;
    });
  </script>
</body>
</html>